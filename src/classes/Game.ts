import {TinyWebXR} from '../lib/TinyWebXR';
import ttt from '../lib/ttt';

new EventSource('/esbuild').addEventListener('change', () => location.reload());

export class Game {
    WebXR: TinyWebXR;
    textures: HTMLCanvasElement[] = [];

    constructor() {
        ttt([[32,32,13119,1,0,-16,4,32,6,32,41784,24856,33316,2,24852,3,2,4100,1],[32,32,95,2,244,1],[32,32,13119,1,-9,-16,6,3,8,8,65521,1,34143,1,-12,-12,6,3,8,8,65521,1,38239,2,13110,1],[32,32,21279,0,4,4,24,24,4,65524,17183,1,0,0,1,6,3,6,65521,1,52417,2,12810,1]]).map((x, i) => {
            x.id = 't' + i;
            this.textures.push(x);
        });

        this.WebXR = new TinyWebXR();

        //  this.WebXR.createGroup({n: 'G', ry: 0});
        document.body.appendChild(this.textures[0]);
        document.body.appendChild(this.textures[1]);
        document.body.appendChild(this.textures[2]);
        document.body.appendChild(this.textures[3]);
        this.WebXR.add('wall', {
            vertices: [2, 3, 0, -2, 3, 0, -2, 0, 0, 2, 3, 0, -2, 0, 0, 2, 0, 0],
            uv: [4, 3, 0, 3, 0, 0, 4, 3, 0, 0, 4, 0],
        });
        
this.WebXR.add('Floor', {vertices: [-0.378842,0,2.664209,-0.378842,0,-3.759968,2.076376,0,-3.759968,-0.378842,0,2.664209,2.076376,0,-3.759968,2.076376,0,2.664209,-2.028787,0,2.664209,-2.028787,0,-3.759968,-0.925019,0,-3.759968,-2.028787,0,2.664209,-0.925019,0,-3.759968,-0.925019,0,2.664209,-0.925019,0,2.664209,-0.925019,0,-3.759968,-0.378842,0,-3.759968,-0.925019,0,2.664209,-0.378842,0,-3.759968,-0.378842,0,2.664209,2.076376,0,2.664209,2.076376,0,3.713237,-0.378842,0,3.713237,2.076376,0,2.664209,-0.378842,0,3.713237,-0.378842,0,2.664209,-0.378842,2.5,2.664209,2.076376,2.5,2.664209,2.076376,2.5,-3.759968,-0.378842,2.5,2.664209,2.076376,2.5,-3.759968,-0.378842,2.5,-3.759968,-2.028787,2.5,2.664209,-0.925019,2.5,2.664209,-0.925019,2.5,-3.759968,-2.028787,2.5,2.664209,-0.925019,2.5,-3.759968,-2.028787,2.5,-3.759968,-0.925019,2.5,2.664209,-0.378842,2.5,2.664209,-0.378842,2.5,-3.759968,-0.925019,2.5,2.664209,-0.378842,2.5,-3.759968,-0.925019,2.5,-3.759968,2.076376,2.5,2.664209,-0.378842,2.5,2.664209,-0.378842,2.5,3.713237,2.076376,2.5,2.664209,-0.378842,2.5,3.713237,2.076376,2.5,3.713237,-1.921296,0,2.664209,-1.03251,0,2.664209,-1.03251,0,2.791433,-1.921296,0,2.664209,-1.03251,0,2.791433,-1.921296,0,2.791433], uv: [0.40545,-1.298033,0.40545,5.126144,2.860668,5.126144,0.40545,-1.298033,2.860668,5.126144,2.860668,-1.298033,-1.244495,-1.298033,-1.244495,5.126144,-0.140727,5.126144,-1.244495,-1.298033,-0.140727,5.126144,-0.140727,-1.298033,-0.140727,-1.298033,-0.140727,5.126144,0.40545,5.126144,-0.140727,-1.298033,0.40545,5.126144,0.40545,-1.298033,2.860668,-1.298033,2.860668,-2.34706,0.40545,-2.34706,2.860668,-1.298033,0.40545,-2.34706,0.40545,-1.298033,0.40545,-1.298033,2.860668,-1.298033,2.860668,5.126144,0.40545,-1.298033,2.860668,5.126144,0.40545,5.126144,-1.244495,-1.298033,-0.140727,-1.298033,-0.140727,5.126144,-1.244495,-1.298033,-0.140727,5.126144,-1.244495,5.126144,-0.140727,-1.298033,0.40545,-1.298033,0.40545,5.126144,-0.140727,-1.298033,0.40545,5.126144,-0.140727,5.126144,2.860668,-1.298033,0.40545,-1.298033,0.40545,-2.34706,2.860668,-1.298033,0.40545,-2.34706,2.860668,-2.34706,-1.137004,-1.298033,-0.248218,-1.298033,-0.248218,-1.425256,-1.137004,-1.298033,-0.248218,-1.425256,-1.137004,-1.425256]}); 
this.WebXR.add('Walls1', {vertices: [-1.921296,2.285018,2.664209,-1.921296,0,2.664209,-1.921296,0,2.791433,-1.921296,2.285018,2.664209,-1.921296,0,2.791433,-1.921296,2.285018,2.791433,2.076376,0,3.713237,2.076376,0,2.664209,2.076376,2.5,2.664209,2.076376,0,3.713237,2.076376,2.5,2.664209,2.076376,2.5,3.713237,-0.925019,0,2.664209,-0.378842,0,2.664209,-0.378842,2.5,2.664209,-0.925019,0,2.664209,-0.378842,2.5,2.664209,-0.925019,2.5,2.664209,-0.378842,0,2.664209,-0.378842,0,3.713237,-0.378842,2.5,3.713237,-0.378842,0,2.664209,-0.378842,2.5,3.713237,-0.378842,2.5,2.664209,2.076376,0,2.664209,2.076376,0,-3.759968,2.076376,2.5,-3.759968,2.076376,0,2.664209,2.076376,2.5,-3.759968,2.076376,2.5,2.664209,-0.378842,0,3.713237,2.076376,0,3.713237,2.076376,2.5,3.713237,-0.378842,0,3.713237,2.076376,2.5,3.713237,-0.378842,2.5,3.713237,-2.028787,0,-3.759968,-2.028787,0,2.664209,-2.028787,2.5,2.664209,-2.028787,0,-3.759968,-2.028787,2.5,2.664209,-2.028787,2.5,-3.759968,1.054513,0,1.183601,1.054513,2.5,1.183601,2.076376,2.5,1.183601,1.054513,0,1.183601,2.076376,2.5,1.183601,2.076376,0,1.183601,1.054513,0,1.065467,2.076376,0,1.065467,2.076376,2.5,1.065467,1.054513,0,1.065467,2.076376,2.5,1.065467,1.054513,2.5,1.065467,1.054513,2.5,1.183601,1.054513,0,1.183601,1.054513,0,1.065467,1.054513,2.5,1.183601,1.054513,0,1.065467,1.054513,2.5,1.065467,2.076376,2.5,1.183601,1.054513,2.5,1.183601,1.054513,2.5,1.065467,2.076376,2.5,1.183601,1.054513,2.5,1.065467,2.076376,2.5,1.065467,2.076376,0,1.183601,2.076376,2.5,1.183601,2.076376,2.5,1.065467,2.076376,0,1.183601,2.076376,2.5,1.065467,2.076376,0,1.065467,1.054513,0,1.183601,2.076376,0,1.183601,2.076376,0,1.065467,1.054513,0,1.183601,2.076376,0,1.065467,1.054513,0,1.065467,-0.922257,0,1.183601,-0.922257,2.5,1.183601,0.054513,2.5,1.183601,-0.922257,0,1.183601,0.054513,2.5,1.183601,0.054513,0,1.183601,-0.922257,0,1.065467,0.054513,0,1.065467,0.054513,2.5,1.065467,-0.922257,0,1.065467,0.054513,2.5,1.065467,-0.922257,2.5,1.065467,-0.922257,2.5,1.183601,-0.922257,0,1.183601,-0.922257,0,1.065467,-0.922257,2.5,1.183601,-0.922257,0,1.065467,-0.922257,2.5,1.065467,0.054513,2.5,1.183601,-0.922257,2.5,1.183601,-0.922257,2.5,1.065467,0.054513,2.5,1.183601,-0.922257,2.5,1.065467,0.054513,2.5,1.065467,0.054513,0,1.183601,0.054513,2.5,1.183601,0.054513,2.5,1.065467,0.054513,0,1.183601,0.054513,2.5,1.065467,0.054513,0,1.065467,-0.922257,0,1.183601,0.054513,0,1.183601,0.054513,0,1.065467,-0.922257,0,1.183601,0.054513,0,1.065467,-0.922257,0,1.065467,-0.804123,0,2.664209,-0.804123,2.5,2.664209,-0.804123,2.5,1.183601,-0.804123,0,2.664209,-0.804123,2.5,1.183601,-0.804123,0,1.183601,-0.922257,0,2.664209,-0.922257,0,1.183601,-0.922257,2.5,1.183601,-0.922257,0,2.664209,-0.922257,2.5,1.183601,-0.922257,2.5,2.664209,-0.804123,2.5,2.664209,-0.804123,0,2.664209,-0.922257,0,2.664209,-0.804123,2.5,2.664209,-0.922257,0,2.664209,-0.922257,2.5,2.664209,-0.804123,2.5,1.183601,-0.804123,2.5,2.664209,-0.922257,2.5,2.664209,-0.804123,2.5,1.183601,-0.922257,2.5,2.664209,-0.922257,2.5,1.183601,-0.804123,0,1.183601,-0.804123,2.5,1.183601,-0.922257,2.5,1.183601,-0.804123,0,1.183601,-0.922257,2.5,1.183601,-0.922257,0,1.183601,-0.804123,0,2.664209,-0.804123,0,1.183601,-0.922257,0,1.183601,-0.804123,0,2.664209,-0.922257,0,1.183601,-0.922257,0,2.664209,-1.921296,2.285018,2.664209,-1.03251,2.285018,2.664209,-0.925019,2.5,2.664209,-1.921296,2.285018,2.664209,-0.925019,2.5,2.664209,-2.028787,2.5,2.664209,-1.03251,2.285018,2.664209,-1.03251,0,2.664209,-0.925019,0,2.664209,-1.03251,2.285018,2.664209,-0.925019,0,2.664209,-0.925019,2.5,2.664209,-1.921296,0,2.664209,-1.921296,2.285018,2.664209,-2.028787,2.5,2.664209,-1.921296,0,2.664209,-2.028787,2.5,2.664209,-2.028787,0,2.664209,-1.03251,2.285018,2.664209,-1.921296,2.285018,2.664209,-1.921296,2.285018,2.791433,-1.03251,2.285018,2.664209,-1.921296,2.285018,2.791433,-1.03251,2.285018,2.791433,-1.03251,0,2.664209,-1.03251,2.285018,2.664209,-1.03251,2.285018,2.791433,-1.03251,0,2.664209,-1.03251,2.285018,2.791433,-1.03251,0,2.791433], uv: [-1.298033,1.647313,-1.298033,-0.637705,-1.425256,-0.637705,-1.298033,1.647313,-1.425256,-0.637705,-1.425256,1.647313,-2.34706,-0.637705,-1.298033,-0.637705,-1.298033,1.862295,-2.34706,-0.637705,-1.298033,1.862295,-2.34706,1.862295,-0.140727,-0.637705,0.40545,-0.637705,0.40545,1.862295,-0.140727,-0.637705,0.40545,1.862295,-0.140727,1.862295,-1.298033,-0.637705,-2.34706,-0.637705,-2.34706,1.862295,-1.298033,-0.637705,-2.34706,1.862295,-1.298033,1.862295,-1.298033,-0.637705,5.126144,-0.637705,5.126144,1.862295,-1.298033,-0.637705,5.126144,1.862295,-1.298033,1.862295,0.40545,-0.637705,2.860668,-0.637705,2.860668,1.862295,0.40545,-0.637705,2.860668,1.862295,0.40545,1.862295,5.126144,-0.637705,-1.298033,-0.637705,-1.298033,1.862295,5.126144,-0.637705,-1.298033,1.862295,5.126144,1.862295,1.838805,-0.637705,1.838805,1.862295,2.860668,1.862295,1.838805,-0.637705,2.860668,1.862295,2.860668,-0.637705,1.838805,-0.637705,2.860668,-0.637705,2.860668,1.862295,1.838805,-0.637705,2.860668,1.862295,1.838805,1.862295,0.182576,1.862295,0.182576,-0.637705,0.300709,-0.637705,0.182576,1.862295,0.300709,-0.637705,0.300709,1.862295,2.860668,0.182576,1.838805,0.182576,1.838805,0.300709,2.860668,0.182576,1.838805,0.300709,2.860668,0.300709,0.182576,-0.637705,0.182576,1.862295,0.300709,1.862295,0.182576,-0.637705,0.300709,1.862295,0.300709,-0.637705,1.838805,0.182576,2.860668,0.182576,2.860668,0.300709,1.838805,0.182576,2.860668,0.300709,1.838805,0.300709,-0.137965,-0.637705,-0.137965,1.862295,0.838805,1.862295,-0.137965,-0.637705,0.838805,1.862295,0.838805,-0.637705,-0.137965,-0.637705,0.838805,-0.637705,0.838805,1.862295,-0.137965,-0.637705,0.838805,1.862295,-0.137965,1.862295,0.182576,1.862295,0.182576,-0.637705,0.300709,-0.637705,0.182576,1.862295,0.300709,-0.637705,0.300709,1.862295,0.838805,0.182576,-0.137965,0.182576,-0.137965,0.300709,0.838805,0.182576,-0.137965,0.300709,0.838805,0.300709,0.182576,-0.637705,0.182576,1.862295,0.300709,1.862295,0.182576,-0.637705,0.300709,1.862295,0.300709,-0.637705,-0.137965,0.182576,0.838805,0.182576,0.838805,0.300709,-0.137965,0.182576,0.838805,0.300709,-0.137965,0.300709,-1.298033,-0.637705,-1.298033,1.862295,0.182576,1.862295,-1.298033,-0.637705,0.182576,1.862295,0.182576,-0.637705,-1.298033,-0.637705,0.182576,-0.637705,0.182576,1.862295,-1.298033,-0.637705,0.182576,1.862295,-1.298033,1.862295,-0.019831,1.862295,-0.019831,-0.637705,-0.137965,-0.637705,-0.019831,1.862295,-0.137965,-0.637705,-0.137965,1.862295,-0.019831,0.182576,-0.019831,-1.298033,-0.137965,-1.298033,-0.019831,0.182576,-0.137965,-1.298033,-0.137965,0.182576,-0.019831,-0.637705,-0.019831,1.862295,-0.137965,1.862295,-0.019831,-0.637705,-0.137965,1.862295,-0.137965,-0.637705,-0.019831,-1.298033,-0.019831,0.182576,-0.137965,0.182576,-0.019831,-1.298033,-0.137965,0.182576,-0.137965,-1.298033,-1.137004,1.647313,-0.248218,1.647313,-0.140727,1.862295,-1.137004,1.647313,-0.140727,1.862295,-1.244495,1.862295,-0.248218,1.647313,-0.248218,-0.637705,-0.140727,-0.637705,-0.248218,1.647313,-0.140727,-0.637705,-0.140727,1.862295,-1.137004,-0.637705,-1.137004,1.647313,-1.244495,1.862295,-1.137004,-0.637705,-1.244495,1.862295,-1.244495,-0.637705,-0.248218,-1.298033,-1.137004,-1.298033,-1.137004,-1.425256,-0.248218,-1.298033,-1.137004,-1.425256,-0.248218,-1.425256,-1.298033,-0.637705,-1.298033,1.647313,-1.425256,1.647313,-1.298033,-0.637705,-1.425256,1.647313,-1.425256,-0.637705]});
this.WebXR.add('Walls2', {vertices: [2.076376,0,-3.759968,-0.378842,0,-3.759968,-0.378842,2.5,-3.759968,2.076376,0,-3.759968,-0.378842,2.5,-3.759968,2.076376,2.5,-3.759968,-0.925019,0,-3.759968,-2.028787,0,-3.759968,-2.028787,2.5,-3.759968,-0.925019,0,-3.759968,-2.028787,2.5,-3.759968,-0.925019,2.5,-3.759968,-0.378842,0,-3.759968,-0.925019,0,-3.759968,-0.925019,2.5,-3.759968,-0.378842,0,-3.759968,-0.925019,2.5,-3.759968,-0.378842,2.5,-3.759968], uv: [2.860668,-0.637705,0.40545,-0.637705,0.40545,1.862295,2.860668,-0.637705,0.40545,1.862295,2.860668,1.862295,-0.140727,-0.637705,-1.244495,-0.637705,-1.244495,1.862295,-0.140727,-0.637705,-1.244495,1.862295,-0.140727,1.862295,0.40545,-0.637705,-0.140727,-0.637705,-0.140727,1.862295,0.40545,-0.637705,-0.140727,1.862295,0.40545,1.862295]});
this.WebXR.add('Bed', {vertices: [-1.851575,0,-0.234056,-1.851575,0.5,-0.234056,0.676684,0.5,-0.234056,-1.851575,0,-0.234056,0.676684,0.5,-0.234056,0.676684,0,-0.234056,-1.851575,0,-2.352587,0.676684,0,-2.352587,0.676684,0.5,-2.352587,-1.851575,0,-2.352587,0.676684,0.5,-2.352587,-1.851575,0.5,-2.352587,-1.851575,0.5,-0.234056,-1.851575,0,-0.234056,-1.851575,0,-2.352587,-1.851575,0.5,-0.234056,-1.851575,0,-2.352587,-1.851575,0.5,-2.352587,0.676684,0.5,-0.234056,-1.851575,0.5,-0.234056,-1.851575,0.5,-2.352587,0.676684,0.5,-0.234056,-1.851575,0.5,-2.352587,0.676684,0.5,-2.352587,0.676684,0,-0.234056,0.676684,0.5,-0.234056,0.676684,0.5,-2.352587,0.676684,0,-0.234056,0.676684,0.5,-2.352587,0.676684,0,-2.352587,-1.851575,0,-0.234056,0.676684,0,-0.234056,0.676684,0,-2.352587,-1.851575,0,-0.234056,0.676684,0,-2.352587,-1.851575,0,-2.352587], uv: [-1.067283,-0.637705,-1.067283,-0.137705,1.460976,-0.137705,-1.067283,-0.637705,1.460976,-0.137705,1.460976,-0.637705,-1.067283,-0.637705,1.460976,-0.637705,1.460976,-0.137705,-1.067283,-0.637705,1.460976,-0.137705,-1.067283,-0.137705,1.600233,-0.137705,1.600233,-0.637705,3.718764,-0.637705,1.600233,-0.137705,3.718764,-0.637705,3.718764,-0.137705,1.460976,1.600233,-1.067283,1.600233,-1.067283,3.718764,1.460976,1.600233,-1.067283,3.718764,1.460976,3.718764,1.600233,-0.637705,1.600233,-0.137705,3.718764,-0.137705,1.600233,-0.637705,3.718764,-0.137705,3.718764,-0.637705,-1.067283,1.600233,1.460976,1.600233,1.460976,3.718764,-1.067283,1.600233,1.460976,3.718764,-1.067283,3.718764]});
this.WebXR.add('Door', {vertices: [-1.921296,0,2.791433,-1.03251,0,2.791433,-1.03251,2.285018,2.791433,-1.921296,0,2.791433,-1.03251,2.285018,2.791433,-1.921296,2.285018,2.791433], uv: [-1.137004,-0.637705,-0.248218,-0.637705,-0.248218,1.647313,-1.137004,-0.637705,-0.248218,1.647313,-1.137004,1.647313]});

        this.WebXR.instance({t: this.textures[0]}, 'Walls2');
         this.WebXR.instance({t: this.textures[2]}, 'Walls1');
         this.WebXR.instance({t: this.textures[1]}, 'Floor');
         this.WebXR.instance({t: this.textures[3]}, 'Door');
         this.WebXR.instance({b:"EEE"}, 'Bed');
        // this.WebXR.instance({rx: 90, z: 1, t: this.textures[1]}, 'wall');
        // this.WebXR.instance({z: 2, w: 0.5, h: 0.5, b: '#227'}, 'cube');
        //this.WebXR.instance({b: '#747'}, 'testPlane');
        // this.WebXR.instance({x: -1, b: '#f0f'}, 'cube');
        // this.WebXR.instance({x: 2.5, w: 2, b: '#00f', t: this.texture, mix: 0.5}, 'cube');
    }
}
